/*! dewarproductivity 20-10-2017 */
!function(){"use strict";function a(a,b){a.state("login",{url:"/login",templateUrl:"App/UI/Login/login.html",controller:"LoginCtrl as login"}).state("home",{url:"/home",templateUrl:"App/UI/Home/home.html",controller:"HomeCtrl as home",resolve:{reqAuth:["$rootScope",function(a){return a.firebaseAuth.$requireSignIn()}]}}).state("home.reminders",{url:"/reminders",views:{homeContent:{templateUrl:"App/UI/Reminders/reminders.html",controller:"RemindersCtrl as reminders"}}}).state("home.users",{url:"/users",views:{homeContent:{templateUrl:"App/UI/Settings/users.html",controller:"UsersCtrl as users"}}}).state("home.productivityItem",{url:"/productivityItem/:itemName/:itemKey",views:{homeContent:{templateUrl:"App/UI/ProductivityItem/productivityItem.html",controller:"ProductivityItemCtrl as productivityItem"}}}).state("home.productivityItemSettings",{url:"/productivityItemSettings/:itemName/:itemKey",views:{homeContent:{templateUrl:"App/UI/ProductivityItem/productivityItemSettings.html",controller:"ProductivityItemSettingsCtrl as productivityItemSettings"}}}).state("home.archive",{url:"/archive",views:{homeContent:{templateUrl:"App/UI/Archive/archive.html",controller:"ArchiveCtrl as archive"}}}),b.otherwise("/login")}angular.module("app.config",[]).config(a),a.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("InteractiveMap",["ui.router","ngMaterial","firebase","app.run","app.config","login.controllers","home.controllers","reminders.controllers","productivityItem.controllers","settings.controllers","archive.controllers","ui.services"])}(),function(){"use strict";function a(a,b,c){b.user=null;var d={apiKey:"AIzaSyDHWwuMQYM75tk3NIlrLr9WpMTZkuw5nmk",authDomain:"dewarproductivitytest.firebaseapp.com",databaseURL:"https://dewarproductivitytest.firebaseio.com",storageBucket:"dewarproductivitytest.appspot.com",messagingSenderId:"1009619404844"};firebase.initializeApp(d),b.firebaseRef=firebase.database().ref(),b.firebaseAuth=a(),b.user=null,b.firebaseAuth.$onAuthStateChanged(function(a){a?b.user=a:c.go("login")})}angular.module("app.run",[]).run(a),a.$inject=["$firebaseAuth","$rootScope","$state"]}(),function(){"use strict";angular.module("archive.controllers",["archive.controller"])}(),function(){"use strict";angular.module("home.controllers",["home.controller"])}(),function(){"use strict";angular.module("login.controllers",["login.controller"])}(),function(){"use strict";angular.module("productivityItem.controllers",["productivityItem.controller","addField.controller","editField.controller","changeDays.controller"])}(),function(){"use strict";angular.module("reminders.controllers",["reminders.controller","updateStatus.controller"])}(),function(){"use strict";angular.module("settings.controllers",["users.controller","addUser.controller","editUser.controller"])}(),function(){"use strict";angular.module("ui.services",["addArr.service","checkExist.service","createUser.service","focus.directive","loadArr.service","loadObj.service","login.service","setObj.service","updateObj.service","ignoremousewheel.directive"])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){o.loading=!0;var a=new Date;a.setDate(a.getDate()-o.startDay),a=a.getTime();var b=new Date;b.setDate(b.getDate()+o.endDay),b=b.getTime();var d=c.firebaseRef,f=d.child("archive");f.orderByChild("date").endAt(b).on("value",function(b){e(function(){o.archive=[],angular.forEach(b.val(),function(b,c){b.date>a&&(b.reminderKey=c,o.archive.push(b))}),o.loading=!1})})}function k(a){a.selected?o.selected.push(a):o.selected.splice(o.selected.indexOf(a),1)}function l(b){a.show(a.confirm().title("Would you like to remove order(s) from archive?").textContent("Order(s) will be permanently deleted.").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose("true")).then(function(){angular.forEach(o.selected,function(a,b){i("archive/"+a.reminderKey,null)}),o.selected=[],a.hide()})}function m(b,d){h("userNames/"+c.user.uid).then(function(c){a.show(a.confirm().title("Would you like to un-archive this order?").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose("true")).then(function(){o.selected=[],d.location=null,d.completeComment=null,d.completedBy=null,d.completedOn=null,d.reviewComment=null,d.reviewedBy=null,d.status=null,d.selected=null,i("reminders/"+d.reminderKey,d),i("archive/"+d.reminderKey,null),i("itemProductivity/"+d.itemKey+"/"+d.orderKey+"/complete",null),d.fieldKey&&i("itemProductivity/"+d.itemKey+"/"+d.orderKey+"/"+d.fieldKey+"/complete",null),"ship date"!==d.action?h("itemProductivity/"+d.itemKey+"/"+d.orderKey).then(function(a){i("archive/"+a.data.shipDateReminderKey,null);var b=d;b.action="ship date",b.date=a.data.shipDate,b.reminderKey=a.data.shipDateReminderKey,i("reminders/"+a.data.shipDateReminderKey,b),j()}):j()})})}function n(){b("left").toggle()}var o=this;o.form,o.archive=[],o.selected=[],o.startDay=7,o.endDay=7,o.loading=!0,o.unArchive=m,o.toggleMenu=n,o.loadArchive=j,o.deleteSelected=l,o.selectedChanged=k,b("left").close(),e(function(){j()},800)}angular.module("archive.controller",[]).controller("ArchiveCtrl",a),a.$inject=["$mdDialog","$mdSidenav","$rootScope","$stateParams","$timeout","AddArrService","LoadArrService","LoadObjService","SetObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){i("productivityList").then(function(a){a.success&&(r.productivityList=a.data,l())})}function l(){h("users/"+c.user.uid).then(function(a){r.loading=!1,r.user=a})}function m(){var a=r.newItemTitle.toLowerCase();g(r.productivityList,"itemName",a).then(function(b){"notExist"===b?(r.newItemTitle="",r.disableSubmit=!1,r.newItem=!1,n(a)):r.error="Item already exist please try again."})}function n(a){var b=c.firebaseRef,e=b.child("productivityList"),f=e.push({itemName:a}),g=[{category:"text",fieldName:"customer"},{category:"text",fieldName:"order #"},{category:"text",fieldName:"variety"},{category:"text",fieldName:"cuttings"},{category:"text",fieldName:"ppp"},{category:"text",fieldName:"qty of pots"},{category:"text",fieldName:"pot size"},{category:"text",fieldName:"pot id"},{category:"text",fieldName:"soil"}],h=b.child("fields/"+f.key);angular.forEach(g,function(a,b){h.push(a)}),d.go("home.productivityItem",{itemName:a,itemKey:f.key})}function o(b,c){a.show(a.confirm().title("Would you like to remove item?").textContent(q(c.itemName)+" will be permanently deleted.").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose("true")).then(function(){r.newItem=!1,r.editItem=!1,j("fields/"+c.$id,null),j("notes/"+c.$id,null),j("productivityList/"+c.$id,null),h("itemProductivity/"+c.$id).then(function(a){angular.forEach(a.data,function(a,b){a.shipDate&&(angular.forEach(a,function(a,b){"reminder"===a.category&&j("reminders/"+a.reminderKey,null)}),j("reminders/"+a.shipDateReminderKey,null))}),j("itemProductivity/"+c.$id,null)}),d.go("home.reminders")})}function p(){r.newItem=!r.newItem,r.editItem=!1,r.newItemTitle="",r.newItem&&e(function(){document.getElementById("addItemInput").focus()})}function q(a){for(var b=a.split(" "),c=0;c<b.length;c++){var d=b[c].charAt(0).toUpperCase();b[c]=d+b[c].substr(1)}return b.join(" ")}var r=this;r.addNewItemForm,r.error="",r.newItemTitle="",r.user=null,r.loading=!0,r.newItem=!1,r.editItem=!1,r.disableSubmit=!1,r.productivityList=[],r.focus=p,r.removItem=o,r.checkExist=m,r.addNewItemForm,r.error="",r.newItemTitle="",r.user=null,r.loading=!0,r.newItem=!1,r.editItem=!1,r.disableSubmit=!1,r.focus=p,r.checkExist=m,r.productivityList=[],r.removItem=o,e(function(){k()})}angular.module("home.controller",[]).controller("HomeCtrl",a),a.$inject=["$mdDialog","$scope","$rootScope","$state","$timeout","AddArrService","CheckExistService","LoadObjService","LoadArrService","SetObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){i.disableSubmit=!0,f(i.email,i.password).then(function(a){a.success?d.go("home.reminders"):(i.error=a.error.message,i.disableSubmit=!1)})}function h(a){i.error="",b.show(b.prompt().title("Enter Email").placeholder("Email").ariaLabel("Email").targetEvent(a).ok("Submit").cancel("Cancel")).then(function(a){c.firebaseAuth.$sendPasswordResetEmail(a).then(function(){i.emailSuccess=!0,e(function(){i.emailSuccess=!1},3e3)})["catch"](function(a){i.error=a.message})},function(){})}var i=this;i.form,i.email="",i.password="",i.error="",i.loading=!1,i.emailSuccess=!1,i.disableSubmit=!1,i.login=g,i.resetPassword=h,a().$signOut()}angular.module("login.controller",[]).controller("LoginCtrl",a),a.$inject=["$firebaseAuth","$mdDialog","$rootScope","$state","$timeout","LoginService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){n.saving=!0,n.disableSubmit=!0;var a=n.newField.toLowerCase();h(c,"fieldName",a).then(function(b){"notExist"===b&&"ship date"!==a&&"shipdate"!==a?l(a):(n.error="Field already exist please try again.",n.saving=!1,n.disableSubmit=!1)})}function l(a){var c={category:n.category,fieldName:a,days:"reminder"===n.category?n.shipDateDifference:null};g("fields/"+d,c).then(function(g){i("userNames/"+firebase.auth().currentUser.uid).then(function(h){angular.forEach(f,function(f,h){if(c.days&&f.shipDate){var i={};angular.forEach(f,function(a,b){"text"===a.category&&(i[b]=a)});var k=new Date(f.shipDate);k.setDate(k.getDate()-c.days);var l=new Date(k);c.value=l.getTime();var m=b.firebaseRef,n={action:a,date:c.value,fields:i,itemKey:d,itemName:e,orderKey:h,fieldKey:g.key};if(!f.complete){var o=m.child("reminders"),p=o.push(n);c.reminderKey=p.key}}else c.value=null,c.reminderKey=null;j("itemProductivity/"+d+"/"+h+"/"+g.key,c)})}),m()})}function m(){a.hide()}var n=this;n.form,n.error="",n.newField="",n.shipDateDifference="",n.saving=!1,n.disableSubmit=!1,n.category="text",n.checkExist=k,n.hide=m}angular.module("addField.controller",[]).controller("AddFieldCtrl",a),a.$inject=["$mdDialog","$rootScope","fields","itemKey","itemName","orders","AddArrService","CheckExistService","LoadObjService","SetObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){var a=b.firebaseRef,h=a.child("fields/"+c+"/"+e+"/disabled");h.set(!0);var k=a.child("itemProductivity/"+c+"/"+d+"/"+e),l=new Date(g);l.setDate(l.getDate()-j.days);var m=new Date(l),n=m.getTime(),o={days:j.days,value:n};if(k.update(o),!f.complete){var p=a.child("reminders/"+f.reminderKey),q={date:n};p.update(q)}i()}function i(){a.hide()}var j=this;j.form,j.days=f.days,j.error="",j.saving=!1,j.disableSubmit=!1,j.save=h,j.hide=i}angular.module("changeDays.controller",[]).controller("ChangeDaysCtrl",a),a.$inject=["$mdDialog","$rootScope","itemKey","orderKey","fieldKey","field","shipDate"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(){o.saving=!0,o.disableSubmit=!0;var a=o.fieldName.toLowerCase();h(c,"fieldName",a).then(function(b){"ship date"!==a&&"shipdate"!==a&&("notExist"===b||"exist"===b&&a===p)?m(a):(o.error="Field already exist please try again.",o.saving=!1,o.disableSubmit=!1)})}function m(a){var c={fieldName:a,days:"reminder"===o.category?o.days:null},e=b.firebaseRef,h=e.child("fields/"+f+"/"+d);h.update(c),i("userNames/"+firebase.auth().currentUser.uid).then(function(b){angular.forEach(g,function(b,g){var h=e.child("itemProductivity/"+f+"/"+g+"/"+d);if(h.update(c),b.shipDate&&!b.complete){if("text"===o.category){j("reminders/"+b.shipDateReminderKey+"/fields/"+d+"/fieldName",a);var i={reviewedBy:null,reviewComment:null,status:null},k=e.child("reminders/"+b.shipDateReminderKey);k.update(i),angular.forEach(b,function(b,c){if("reminder"===b.category&&!b.complete){j("reminders/"+b.reminderKey+"/fields/"+d+"/fieldName",a);var f={reviewedBy:null,reviewComment:null,status:null},g=e.child("reminders/"+b.reminderKey);g.update(f)}})}if("reminder"===o.category){var l=new Date(b.shipDate);l.setDate(l.getDate()-c.days);var m=new Date(l),n=m.getTime();j("itemProductivity/"+f+"/"+g+"/"+d+"/value",n);var p={date:n,action:a,reviewedBy:null,reviewComment:null,status:null},q=e.child("reminders/"+b[d].reminderKey);q.update(p)}}})}),n()}function n(){a.hide()}var o=this,p=e.fieldName;o.form,o.error="",o.days=e.days||"",o.saving=!1,o.disableSubmit=!1,o.fieldName=e.fieldName,o.category=e.category,o.hide=n,o.checkExist=l}angular.module("editField.controller",[]).controller("EditFieldCtrl",a),a.$inject=["$mdDialog","$rootScope","fields","fieldKey","field","itemKey","orders","CheckExistService","LoadObjService","SetObjService","UpdateObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){i("fields/"+e.itemKey).then(function(a){I.fields=a,l()})}function l(){i("itemProductivity/"+e.itemKey).then(function(a){I.orders=a,q(!0,!0)})}function m(){i("notes/"+e.itemKey).then(function(a){I.notes=a,p()})}function n(){I.columnFilter.fieldName&&(I.filteredItems={},angular.forEach(I.orders.data,function(a,b){angular.forEach(a,function(a,b){if(a.fieldName===I.columnFilter.fieldName&&a.value){var c=null;if("string"==typeof a.value)var c=a.value.toLowerCase();if("number"==typeof a.value)var c=new Date(a.value).toLocaleDateString();I.filteredItems[c]=b}})}))}function o(){I.filterObj={},angular.forEach(I.orders.data,function(a,b){var c=null;"string"==typeof a[I.filteredItem.item].value&&(c=a[I.filteredItem.item].value.toLowerCase()),"number"==typeof a[I.filteredItem.item].value&&(c=new Date(a[I.filteredItem.item].value).toLocaleDateString()),c===I.filteredItem.key&&(I.filterObj[b]=!0)})}function p(){I.filterObj={},I.filteredItems=[],I.columnFilter="",I.filteredItem="",I.loading=!1,angular.forEach(I.orders.data,function(a,b){I.filterObj[b]=!0})}function q(a,b){f(function(){var c=null,d=null,f=null,g=0,h=0;angular.forEach(I.orders.data,function(a,i){a.shipDate&&(a.shipDateCalendar=new Date(a.shipDate)),b&&!a.complete&&(angular.forEach(a,function(a,b){"cuttings"===a.fieldName&&(d=b),"ppp"===a.fieldName&&a.value&&(c=a.value),"qty of pots"===a.fieldName&&(f=b,a.value&&(h+=a.value,g+=c*a.value,c=null))}),d&&f&&(j("fields/"+e.itemKey+"/"+d+"/total",g),j("fields/"+e.itemKey+"/"+f+"/total",h)))}),a&&m()})}function r(a,b,d,f){j("itemProductivity/"+e.itemKey+"/"+a+"/"+d+"/value",f.value),b.shipDate&&i("userNames/"+firebase.auth().currentUser.uid).then(function(a){var e=c.firebaseRef,g={status:null,reviewedBy:null,reviewComment:null};angular.forEach(b,function(a,b){if("reminder"===a.category&&!a.complete){var c=e.child("reminders/"+a.reminderKey);j("reminders/"+a.reminderKey+"/fields/"+d,f),c.update(g)}});var h=e.child("reminders/"+b.shipDateReminderKey);j("reminders/"+b.shipDateReminderKey+"/fields/"+d,f),h.update(g)}),q()}function s(a,b){var d=null,f=null,g=null,h=null,j=null,k=null,l=c.firebaseRef;angular.forEach(b,function(a,b){"cuttings"===a.fieldName&&(d=b),"ppp"===a.fieldName&&(g=b,h=a.value||null),"qty of pots"===a.fieldName&&(j=b,k=a.value||null)}),f=h&&k?h*k:null;var m=l.child("itemProductivity/"+e.itemKey+"/"+a),n={};n[d]={category:"text",fieldName:"cuttings",value:f},n[g]={category:"text",fieldName:"ppp",value:h},n[j]={category:"text",fieldName:"qty of pots",value:k},m.update(n),b.shipDate&&i("userNames/"+firebase.auth().currentUser.uid).then(function(a){var c={status:null,reviewedBy:null,reviewComment:null};angular.forEach(b,function(a,b){if("reminder"===a.category&&!a.complete){var d=l.child("reminders/"+a.reminderKey),e=l.child("reminders/"+a.reminderKey+"/fields");d.update(c),e.update(n)}});var d=l.child("reminders/"+b.shipDateReminderKey),e=l.child("reminders/"+b.shipDateReminderKey+"/fields");d.update(c),e.update(n)}),q(!1,!0)}function t(a,b){var d={},f={},g=c.firebaseRef,h=g.child("reminders"),k=new Date(b.shipDateCalendar);j("itemProductivity/"+e.itemKey+"/"+a+"/shipDate",k.getTime()),angular.forEach(b,function(c,g){if("text"===c.category&&(d[g]=c),"reminder"===c.category){var h=new Date(b.shipDateCalendar);h.setDate(h.getDate()-c.days);var i=new Date(h),k=i.getTime();c.value=k,j("itemProductivity/"+e.itemKey+"/"+a+"/"+g+"/value",k),f[g]=f[g]||{},f[g].action=c.fieldName,f[g].complete=c.complete||null,f[g].date=k,f[g].itemName=e.itemName,f[g].itemKey=e.itemKey,f[g].orderKey=a,f[g].fieldKey=g,f[g].reminderKey=c.reminderKey?c.reminderKey:null}}),i("userNames/"+firebase.auth().currentUser.uid).then(function(c){angular.forEach(f,function(b,c){if(b.reminderKey){if(!b.complete){var f={date:b.date,status:null,reviewedBy:null,reviewComment:null},i=g.child("reminders/"+b.reminderKey);i.update(f)}}else{b.fields=d,b.reviewedBy=null,b.reviewComment=null;var k=h.push(b);j("itemProductivity/"+e.itemKey+"/"+a+"/"+c+"/reminderKey",k.key)}});var i={action:"ship date",date:k.getTime(),fields:d,itemKey:e.itemKey,itemName:e.itemName,orderKey:a,status:null,reviewedBy:null,reviewComment:null};if(b.shipDateReminderKey)j("reminders/"+b.shipDateReminderKey,i);else{var l=h.push(i);j("itemProductivity/"+e.itemKey+"/"+a+"/shipDateReminderKey",l.key)}q()})}function u(){I.removeFields=!1,I.editFields=!1,g("itemProductivity/"+e.itemKey,I.fields.data).then(function(a){q(),p()})}function v(){j("notes/"+e.itemKey,I.notes.data.$value)}function w(a){for(var b=a.split(" "),c=0;c<b.length;c++){var d=b[c].charAt(0).toUpperCase();b[c]=d+b[c].substr(1)}return b.join(" ")}function x(b){I.removeFields=!1,I.editFields=!1;var c=[];angular.forEach(I.fields.data,function(a,b){c.push({fieldName:a.fieldName})}),a.show({controller:"AddFieldCtrl",templateUrl:"App/UI/ProductivityItem/addField.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!1,controllerAs:"addField",locals:{fields:c,itemKey:e.itemKey,itemName:e.itemName,orders:I.orders.data}}).then(function(){q()})}function y(b,d,f){a.show(a.confirm().title("Would you like to remove column?").textContent(w(f.fieldName)+" will be permanently deleted. Reminders may also be affected.").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose(!1)).then(function(){j("fields/"+e.itemKey+"/"+d,null),i("userNames/"+firebase.auth().currentUser.uid).then(function(b){var g=c.firebaseRef;angular.forEach(I.orders.data,function(a,b){j("itemProductivity/"+e.itemKey+"/"+b+"/"+d,null),a.shipDate&&!a.complete&&("text"===f.category&&angular.forEach(a,function(b,c){if("reminder"===b.category&&!b.complete){var e=g.child("reminders/"+b.reminderKey),f={status:null,reviewedBy:null,reviewComment:null};j("reminders/"+b.reminderKey+"/fields/"+d,null),e.update(f)}var h={status:null,reviewedBy:null,reviewComment:null};j("reminders/"+a.shipDateReminderKey+"/fields/"+d,null);var i=g.child("reminders/"+a.shipDateReminderKey);i.update(h)}),"reminder"===f.category&&angular.forEach(a,function(a,b){b===d&&j("reminders/"+a.reminderKey,null)}))}),I.removeFields=!1,a.hide(),q()})})}function z(b,c,d){a.show(a.confirm().title("Would you like to remove this order?").textContent("Order "+c.slice(-4)+" will be permanently deleted.").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose(!1)).then(function(){j("itemProductivity/"+e.itemKey+"/"+c,null),d.shipDate&&(angular.forEach(d,function(a,b){"reminder"===a.category&&a.reminderKey&&(j("reminders/"+a.reminderKey,null),j("archive/"+a.reminderKey,null))}),j("reminders/"+d.shipDateReminderKey,null),j("archive/"+d.shipDateReminderKey,null)),q()})}function A(b,c,d){var f=[];angular.forEach(I.fields.data,function(a,b){f.push({fieldName:a.fieldName})}),a.show({controller:"EditFieldCtrl",templateUrl:"App/UI/ProductivityItem/editField.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!1,controllerAs:"editField",locals:{fields:f,fieldKey:c,field:d,itemKey:e.itemKey,orders:I.orders.data}}).then(function(){I.editFields=!1,q()})}function B(b,c,d,f,g){I.editFields=!1,I.removeFields=!1,a.show({controller:"ChangeDaysCtrl",templateUrl:"App/UI/ProductivityItem/changeDays.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!1,controllerAs:"changeDays",locals:{itemKey:e.itemKey,orderKey:c,fieldKey:d,field:f,shipDate:g}}).then(function(){q()})}function C(){I.allSelected?angular.forEach(I.orders.data,function(a,b){a.shipDate&&(I.selectedKeys[b]=!0,J.push({key:b,shipDate:a.shipDate}),I.selectedArr.push(a))}):(I.selectedKeys={},I.selectedArr=[],J=[])}function D(a,b){I.selectedKeys[a]?(I.selectedArr.push(b),J.push({key:a,shipDate:b.shipDate})):(I.selectedArr.splice(I.selectedArr.indexOf(b),1),J.splice(J.indexOf({key:a,shipDate:b.shipDate}),1))}function E(){var a=new jsPDF,b=17,c=5,d=1,f=H(J,"shipDate"),g=H(I.selectedArr,"shipDate");a.setFontSize(12),angular.forEach(g,function(g,h){a.text(5,b,"Ship Date: "+new Date(g.shipDate).toLocaleDateString()),b+=10,a.text(c,b,"Order ID: "+f[h].key.slice(-4)),a.text(c+70,b,"Crop: "+e.itemName),a.text(c+140,b,"Complete: "+(g.complete?"Yes":"No")),b+=10,angular.forEach(g,function(e,f){if(f&&"undefined"!==f&&"complete"!==f&&"shipDate"!==f&&"shipDateCalendar"!==f&&"shipDateReminderKey"!==f){var g="cuttings"===e.fieldName?"cuttings/Bulbs":e.fieldName,h=null;"text"===e.category&&(h=Number(e.value)?Number(e.value).toLocaleString():e.value||""),"reminder"===e.category&&(h=new Date(e.value).toLocaleDateString()),a.text(c,b,w(g)+": "+h),c+=70,c>=155&&(c=5,b+=10),b>=250&&(a.text(187,285,"Page "+d.toString()),d++,a.addPage(),b=17,c=5)}}),a.line(5,b+3,190,b+3),c=5,b+=10}),a.text(187,285,"Page "+d.toString()),a.save(e.itemName)}function F(b){a.show(a.confirm().title("Would you like to remove orders selected?").textContent("These orders will be permanently deleted").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose(!1)).then(function(){angular.forEach(I.orders.data,function(a,b){a.complete&&I.selectedKeys[b]&&j("itemProductivity/"+e.itemKey+"/"+b,null)}),I.selectedKeys={},I.selectedArr=[],J=[]})}function G(){b("left").toggle()}function H(a,b){return a.sort(function(a,c){var d=a[b],e=c[b];return d<e?-1:d>e?1:0})}var I=this,J=[];I.notes="",I.filteredItem="",I.columnFilter="",I.orders={},I.fields={},I.filterObj={},I.selectedKeys=[],I.selectedArr=[],I.filteredItems=[],I.loading=!0,I.allSelected=!1,I.removeFields=!1,I.editFields=!1,I.disableSubmit=!1,I.print=E,I.multiDelete=F,I.addField=x,I.newOrder=u,I.saveNotes=v,I.editField=A,I.dateChange=t,I.toggleMenu=G,I.filterItems=n,I.resetOrders=p,I.changeDays=B,I.selectAll=C,I.removeField=y,I.removeOrder=z,I.changesMade=r,I.valueChange=s,I.selectedChanged=D,I.filterOrders=o,I.itemName=e.itemName,b("left").close(),f(function(){k()},800)}angular.module("productivityItem.controller",[]).controller("ProductivityItemCtrl",a),a.$inject=["$mdDialog","$mdSidenav","$rootScope","$state","$stateParams","$timeout","AddArrService","LoadArrService","LoadObjService","SetObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){n.loading=!0;var a=new Date;a.setDate(a.getDate()+n.days);var b=c.firebaseRef,d=b.child("reminders");d.orderByChild("date").endAt(a.getTime()).on("value",function(a){e(function(){n.reminders=[],angular.forEach(a.val(),function(a,b){a.reminderKey=b,n.reminders.push(a)}),n.loading=!1})})}function h(b,c,d){a.show({controller:"UpdateStatusCtrl",templateUrl:"App/UI/Reminders/updateStatus.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!1,controllerAs:"updateStatus",locals:{reminder:c,action:d}})}function i(a){a.selected?n.selected.push(a):n.selected.splice(n.selected.indexOf(a),1)}function j(){var a=new jsPDF,b=17,c=5,d=1,e=m(n.selected,"date");a.setFontSize(12),angular.forEach(e,function(e,f){a.text(5,b,"Date: "+new Date(e.date).toLocaleDateString()),b+=10,a.text(c,b,"Reminder ID: "+e.reminderKey.slice(-4)),a.text(c+70,b,"Action: "+e.action),a.text(c+140,b,"Crop: "+e.itemName),b+=10,angular.forEach(e.fields,function(e,f){if(e.value){var g="cuttings"===e.fieldName?"cuttings/Bulbs":e.fieldName,h=Number(e.value)?Number(e.value).toLocaleString():e.value;a.text(c,b,l(g)+": "+h),c+=70,c>=155&&(c=5,b+=10),b>=271&&(a.text(187,285,"Page "+d.toString()),d++,a.addPage(),b=17,c=5)}}),a.line(5,b+3,190,b+3),c=5,b+=10}),a.text(187,285,"Page "+d.toString()),n.selected=[],a.save("reminders")}function k(){b("left").toggle()}function l(a){for(var b=a.split(" "),c=0;c<b.length;c++){var d=b[c].charAt(0).toUpperCase();b[c]=d+b[c].substr(1)}return b.join(" ")}function m(a,b){return a.sort(function(a,c){var d=a[b],e=c[b];return d<e?-1:d>e?1:0})}var n=this;n.form,n.reminders=[],n.selected=[],n.loading=!0,n.days=7,n.print=j,n.toggleMenu=k,n.loadReminders=g,n.updateStatus=h,n.selectedChanged=i,b("left").close(),e(function(){g()},800)}angular.module("reminders.controller",[]).controller("RemindersCtrl",a),a.$inject=["$mdDialog","$mdSidenav","$rootScope","$scope","$timeout","LoadArrService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){e("userNames/"+b.user.uid).then(function(a){if("review"===c){var f={status:j.action,reviewComment:j.comment||null,reviewedBy:a.data.userName},h=b.firebaseRef,k=h.child("reminders/"+d.reminderKey);k.update(f)}"complete"===c&&(d.status=j.action,d.location=j.location,d.completeComment=j.comment||null,d.completedBy=a.data.userName,d.completedOn=firebase.database.ServerValue.TIMESTAMP,d.selected=null,g("archive/"+d.reminderKey,d),g("reminders/"+d.reminderKey,null),"ship date"!==d.action&&g("itemProductivity/"+d.itemKey+"/"+d.orderKey+"/"+d.fieldKey+"/complete",!0),"ship date"===d.action&&(g("itemProductivity/"+d.itemKey+"/"+d.orderKey+"/complete",!0),e("itemProductivity/"+d.itemKey).then(function(a){var b=null,c=null,e=null,f=0,h=0;angular.forEach(a.data,function(a,i){a.complete||(angular.forEach(a,function(a,d){"cuttings"===a.fieldName&&(c=d),"ppp"===a.fieldName&&a.value&&(b=a.value),"qty of pots"===a.fieldName&&a.value&&(e=d,h+=a.value,f+=b*a.value,b=null)}),c&&e&&f&&h&&(g("fields/"+d.itemKey+"/"+c+"/total",f),g("fields/"+d.itemKey+"/"+e+"/total",h)))})}))),i()})}function i(){a.hide()}var j=this;j.form,j.email="",j.password="",j.comment="",j.error="",j.index=d.reminderKey,j.action="review"===c?"reviewed":"completed",j.disableSubmit=!1,j.hide=i,j.update=h}angular.module("updateStatus.controller",[]).controller("UpdateStatusCtrl",a),a.$inject=["$mdDialog","$rootScope","action","reminder","LoadObjService","LoginService","SetObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){m.disableSubmit=!0;var a=m.fName.toLowerCase()+" "+(m.mName?m.mName.toLowerCase():"")+" "+m.lName.toLowerCase();d(c,"userName",a).then(function(b){"notExist"===b?i(a):(m.error="User already exist please try again.",m.disableSubmit=!1)})}function i(a){e(m.email,m.password).then(function(b){b.success?j(b.uid,a):(m.error=b.error,m.disableSubmit=!1)})}function j(a,b){var c={};c[a]={isAdmin:m.isAdmin,fName:m.fName,mName:m.mName||null,lName:m.lName,uid:a},g("users",c).then(function(){k(a,b)})}function k(a,c){var d={};d[a]={userName:c,uid:a},g("userNames",d).then(function(){l(),b.go("login")})}function l(){a.hide()}var m=this;m.form,m.fName="",m.mName="",m.lName="",m.email="",m.password="",m.error="",m.isAdmin=!1,m.disableSubmit=!1,m.checkExist=h,m.hide=l}angular.module("addUser.controller",[]).controller("AddUserCtrl",a),a.$inject=["$mdDialog","$state","users","CheckExistService","CreateUserService","SetObjService","UpdateObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){k.disableSubmit=!0;var a=k.fName.toLowerCase()+" "+(k.mName?k.mName.toLowerCase():"")+" "+k.lName.toLowerCase();d(c,"userName",a).then(function(b){"exist"===b&&l!==a?(k.error="User already exist please try again.",k.disableSubmit=!1):h(a)})}function h(a){var c={isAdmin:k.isAdmin,fName:k.fName,mName:k.mName||null,lName:k.lName,uid:b.uid};f("users/"+b.uid,c).then(function(){i(a)})}function i(a){e("userNames/"+b.uid+"/userName",a),j()}function j(){a.hide()}var k=this,l=b.fName+" "+(b.mName?b.mName:"")+" "+b.lName;k.form,k.fName=b.fName,k.mName=b.mName||"",k.lName=b.lName,k.email="",k.password="",k.error="",k.isAdmin=b.isAdmin,k.disableSubmit=!1,k.checkExist=g,k.hide=j}angular.module("editUser.controller",[]).controller("EditUserCtrl",a),a.$inject=["$mdDialog","user","users","CheckExistService","SetObjService","UpdateObjService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){f("userNames").then(function(a){q.users=a.data,q.loading=!1})}function k(b,c){g("users/"+c.uid).then(function(c){a.show({controller:"EditUserCtrl",templateUrl:"App/UI/Settings/editUser.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,controllerAs:"editUser",locals:{user:c.data,users:q.users}})})}function l(b,c){a.show(a.confirm().title("Would you like to remove user?").textContent(o(c.userName)+" will be permanently deleted.").targetEvent(b).ok("Confirm").cancel("Cancel").clickOutsideToClose("true")).then(function(){h("users/"+c.uid,null),h("userNames/"+c.uid,null),a.hide()})}function m(b){a.show({controller:"AddUserCtrl",templateUrl:"App/UI/Settings/addUser.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,controllerAs:"addUser",locals:{users:q.users}})}function n(b){a.show(a.prompt().title("Enter New Password").placeholder("Password").ariaLabel("Password").targetEvent(b).ok("Submit").cancel("Cancel")).then(function(b){d.firebaseAuth.$updatePassword(b).then(function(){c.show({template:"<md-toast><span flex>Password Updated!</span></md-toast>",hideDelay:2e3,position:"bottom right"})})["catch"](function(b){a.show(a.alert().clickOutsideToClose(!0).title("Error").textContent(b.message).ariaLabel("Error").ok("Ok"))})})}function o(a){for(var b=a.split(" "),c=0;c<b.length;c++){var d=b[c].charAt(0).toUpperCase();b[c]=d+b[c].substr(1)}return b.join(" ")}function p(){b("left").toggle()}var q=this;q.users=[],q.loading=!0,q.addUser=m,q.editUser=k,q.deleteUser=l,q.toggleMenu=p,q.changePassword=n,b("left").close(),e(function(){j()})}angular.module("users.controller",[]).controller("UsersCtrl",a),a.$inject=["$mdDialog","$mdSidenav","$mdToast","$rootScope","$timeout","LoadArrService","LoadObjService","SetObjService","UpdateObjService"]}(),function(){"use strict";function a(a,b,c){function d(d,e){var f=b.defer(),g=c.firebaseRef,h=g.child(d),i=a(h);return i.$add(e).then(function(a){f.resolve(a)}),f.promise}return d}angular.module("addArr.service",[]).factory("AddArrService",a),a.$inject=["$firebaseArray","$q","$rootScope"]}(),function(){"use strict";function a(a,b,c){function d(a,c,d){for(var e=b.defer(),f=a.length,g=0;g<f;g++)a[g][c]===d&&e.resolve("exist");return e.resolve("notExist"),e.promise}return d}angular.module("checkExist.service",[]).factory("CheckExistService",a),a.$inject=["$firebaseArray","$q","$rootScope"]}(),function(){"use strict";function a(a,b){function c(c,d){var e=b.defer();return a().$createUserWithEmailAndPassword(c,d).then(function(a){e.resolve({success:!0,uid:a.uid})})["catch"](function(a){e.resolve({error:a.message})}),e.promise}return c}angular.module("createUser.service",[]).factory("CreateUserService",a),a.$inject=["$firebaseAuth","$q"]}(),function(){"use strict";function a(a){return{restrict:"A",link:function(b,c){a(function(){c[0].focus()})}}}angular.module("focus.directive",[]).directive("focus",a),a.$inject=["$timeout"]}(),function(){"use strict";function a(a){return{restrict:"A",link:function(a,b,c){b.bind("mousewheel",function(a){b.blur()})}}}angular.module("ignoremousewheel.directive",[]).directive("ignoremousewheel",a),a.$inject=[]}(),function(){"use strict";function a(a,b){function c(c){var d=b.defer(),e=firebase.database().ref(c),f=a(e);return f.$loaded().then(function(a){d.resolve({success:!0,data:a})})["catch"](function(a){d.resolve({error:a})}),d.promise}return c}angular.module("loadArr.service",[]).factory("LoadArrService",a),a.$inject=["$firebaseArray","$q"]}(),function(){"use strict";function a(a,b){function c(c){var d=b.defer(),e=firebase.database().ref(c),f=a(e);return f.$loaded().then(function(a){d.resolve({success:!0,data:a})})["catch"](function(a){d.resolve({error:a})}),d.promise}return c}angular.module("loadObj.service",[]).factory("LoadObjService",a),a.$inject=["$firebaseObject","$q"]}(),function(){"use strict";function a(a,b){function c(c,d){var e=a.defer();return b.firebaseAuth.$signInWithEmailAndPassword(c,d).then(function(a){
e.resolve({success:!0,user:a})})["catch"](function(a){e.resolve({error:a})}),e.promise}return c}angular.module("login.service",[]).factory("LoginService",a),a.$inject=["$q","$rootScope"]}(),function(){"use strict";function a(a){function b(b,c){var d=a.firebaseRef,e=d.child(b);e.set(c)}return b}angular.module("setObj.service",[]).factory("SetObjService",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(a){function b(b,c){var d=a.defer(),e=firebase.database().ref(b);return e.update(c,function(a){a?console.log("Synchronization failed"):d.resolve(c)}),d.promise}return b}angular.module("updateObj.service",[]).factory("UpdateObjService",a),a.$inject=["$q"]}();